metadata:
- description: "\n            Check all properties and configuration files and all
    environment variables on the production deployment(s) for any secret strings and
    passwords.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-xml,3.0.0.Final
  sourceTechnology:
  - id: springboot
  - id: eap
    versionRange: '[7,8)'
  targetTechnology:
  - id: azure-appservice
  - id: azure-aks
  - id: azure-container-apps
  tag:
  - password
  - security
rules:
  rule:
  - when:
      or:
      - xmlfile:
        - matches: //password
        - matches: //*[@name='Password']
        filecontent:
        - pattern: '{password}'
          filename: application{*}.{extensions}
    perform:
      hint:
      - message: "\n                        \n                        Password found
          in configuration file.\n\n                        Consider using Azure Key
          Vault and/or parameter injection with application settings where possible.\n
          \                       \n                    "
        link:
        - value: ""
          title: Password found in configuration file
          href: https://docs.microsoft.com/azure/developer/java/migration/migrate-spring-boot-to-app-service#passwords-and-secure-strings
        - value: ""
          title: Key Vault
          href: https://docs.microsoft.com/azure/key-vault/
        - value: ""
          title: Use Key Vault references
          href: https://docs.microsoft.com/azure/app-service/app-service-key-vault-references?tabs=azure-cli
        - value: ""
          title: Read a secret from Azure Key Vault in a Spring Boot application
          href: https://docs.microsoft.com/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-key-vault
        - value: ""
          title: Azure Spring Boot Starter for Azure Key Vault Secrets
          href: https://search.maven.org/artifact/com.azure.spring/azure-spring-boot-starter-keyvault-secrets
        title: Password found in configuration file
        category-id: potential
        effort: 3
    where:
    - matches:
      - value: ""
        pattern: (properties|yaml|yml)
      param: extensions
    - matches:
      - value: ""
        pattern: (password|pwd)
      param: password
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/azure/azure-password.windup.xml
