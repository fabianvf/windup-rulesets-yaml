metadata:
- description: "\n            External resources such as data sources are injected
    via Java Naming and Directory Interface (JNDI). Some such resources may require
    migration or reconfiguration.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-xml,3.0.0.Final
  sourceTechnology:
  - id: eap
    versionRange: '[7,8)'
  targetTechnology:
  - id: azure-appservice
  - id: azure-aks
  tag:
  - password
  - security
rules:
  rule:
  - when:
      or:
      - xmlfile:
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:db2')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'db2')]
          in: '{*}-ds.xml'
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:mysql')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'mysql')]
          in: '{*}-ds.xml'
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:oracle')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'oracle')]
          in: '{*}-ds.xml'
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:postgres')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'postgres')]
          in: '{*}-ds.xml'
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:microsoft:sqlserver')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'sqlserver')]
          in: '{*}-ds.xml'
        - matches: /datasources/datasource/connection-url[contains(text(),'jdbc:sybase')]
          in: '{*}-ds.xml'
        - matches: /datasources/drivers/driver/xa-datasource-class[contains(text(),'sybase')]
          in: '{*}-ds.xml'
    perform:
      hint:
      - message: "\n                        \n                        A datasource
          driver was found in a configuration file.\n\n                        There
          are three core steps when registering a data source with JBoss EAP in Azure
          App Service: uploading the JDBC driver, adding the JDBC driver as a module,
          and registering the module.\n\n                        App Service is a
          stateless hosting service, so the configuration commands for adding and
          registering the data source module must be scripted and applied as the container
          starts.\n                        \n                        For more information,
          see Datasource Management in the JBoss EAP documentation.                        \n
          \                       \n                    "
        link:
        - value: ""
          title: Migrate JBoss EAP applications to JBoss EAP on Azure App Service
            - Datasources
          href: https://docs.microsoft.com/en-us/azure/developer/java/migration/migrate-jboss-eap-to-jboss-eap-on-azure-app-service#datasources
        - value: ""
          title: Migrate JBoss EAP applications to JBoss EAP on Azure App Service
            - Set up data sources
          href: https://docs.microsoft.com/en-us/azure/developer/java/migration/migrate-jboss-eap-to-jboss-eap-on-azure-app-service#set-up-data-sources
        - value: ""
          title: Datasource Management
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.4/html/configuration_guide/datasource_management
        title: Datasource driver found in configuration file
        category-id: potential
        effort: 3
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/azure/eap/eap-to-azure-appservice-datasource-driver.windup.xml
