metadata:
- description: "\n            This ruleset provides informative, not actionable rules.
    It identifies some Apache Axis, XFire or Apache CXF configuration for Web Services.\n
    \       "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,2.3.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,2.3.0.Final
  sourceTechnology:
  - id: java-ee
  targetTechnology:
  - id: eap
    versionRange: '[6,)'
  tag:
  - webservice
rules:
  rule:
  - when:
      xmlfile:
      - as: default
        matches: /serviceGroup/service/operation
    perform:
      iteration:
      - classification:
        - tag:
          - apache-axis
          - webservice
          title: Apache Axis Service Group
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - as: default
        matches: /module/InFlow
    perform:
      iteration:
      - classification:
        - tag:
          - apache-axis
          - webservice
          title: Apache Axis Module
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - as: default
        matches: /axisconfig
    perform:
      iteration:
      - classification:
        - tag:
          - apache-axis
          - webservice
          title: Apache Axis Configuration
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: xfire
          uri: http://xfire.codehaus.org/config/1.0
        as: default
        matches: /xfire:beans
    perform:
      iteration:
      - classification:
        - tag:
          - xfire
          - webservice
          title: XFire 1.x Configuration
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: j2e
          uri: http://java.sun.com/xml/ns/j2ee
        - value: ""
          prefix: jcp
          uri: http://xmlns.jcp.org/xml/ns/javaee
        - value: ""
          prefix: jee
          uri: http://java.sun.com/xml/ns/javaee
        as: default
        matches: /*[local-name()='handler-chains']
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          title: JAX-WS Handler Chain
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: j2e
          uri: http://java.sun.com/xml/ns/j2ee
        - value: ""
          prefix: jcp
          uri: http://xmlns.jcp.org/xml/ns/javaee
        - value: ""
          prefix: jee
          uri: http://java.sun.com/xml/ns/javaee
        as: webservices
        matches: /*[local-name()='webservices']
      - namespace:
        - value: ""
          prefix: j2e
          uri: http://java.sun.com/xml/ns/j2ee
        - value: ""
          prefix: jcp
          uri: http://xmlns.jcp.org/xml/ns/javaee
        - value: ""
          prefix: jee
          uri: http://java.sun.com/xml/ns/javaee
        as: handler-classes
        matches: //*[local-name()='handler-class']
        from: webservices
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          title: Java Webservice Configuration
          category-id: optional
          issue-display-mode: detail-only
        over: webservices
      - hint:
        - message: JBoss EAP developer documentation describes JAX-WS Web Services
            Common API.
          link:
          - value: JBoss EAP 6 - JAX-WS Web Services Common API
            title: JBoss EAP 6 - JAX-WS Web Services Common API
            href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/sect-JAX-WS_Development_Reference.html#JAX-WS_Common_API_Reference
          - value: JBoss EAP 7 - JAX-WS Web Services Common API
            title: JBoss EAP 7 - JAX-WS Web Services Common API
            href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/developing_web_services_applications/#jax_ws_common_api_reference
          title: Use of Web Service Handler2
          category-id: optional
        over: handler-classes
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: j2e
          uri: http://java.sun.com/xml/ns/j2ee
        - value: ""
          prefix: jcp
          uri: http://xmlns.jcp.org/xml/ns/javaee
        - value: ""
          prefix: jee
          uri: http://java.sun.com/xml/ns/javaee
        as: webservices
        matches: /*[local-name()='webservices']
      - namespace:
        - value: ""
          prefix: j2e
          uri: http://java.sun.com/xml/ns/j2ee
        - value: ""
          prefix: jcp
          uri: http://xmlns.jcp.org/xml/ns/javaee
        - value: ""
          prefix: jee
          uri: http://java.sun.com/xml/ns/javaee
        as: endpoints
        matches: //*[local-name()='service-endpoint-interface']
        from: webservices
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          title: Java Webservice Configuration
          category-id: optional
          issue-display-mode: detail-only
        over: webservices
      - hint:
        - message: JBoss EAP developer documentation about JAX-WS Web Services Endpoints
          link:
          - value: JBoss EAP 6 - JAX-WS Web Service Endpoints
            title: JBoss EAP 6 -  JAX-WS Web Services Endpoints
            href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/sect-JAX-WS_Web_Service_Endpoints.html
          - value: JBoss EAP 7 - JAX-WS Web Service Endpoints
            title: JBoss EAP 7 - JAX-WS Web Services Endpoints
            href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/developing_web_services_applications/#jax_ws_web_service_endpoints
          title: Use of Web Service Handler2
          category-id: optional
        over: endpoints
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: cxf
          uri: http://cxf.apache.org/bus/extension
        as: default
        matches: /extensions
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          - apache-cxf
          title: Apache CXF Bus Extension
          category-id: optional
          issue-display-mode: all
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: wsp
          uri: http://schemas.xmlsoap.org/ws/2004/09/policy
        as: default
        matches: //*[local-name()='Policy']
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          - security
          title: WS-Policy
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: se
          uri: http://schemas.xmlsoap.org/soap/envelope/
        as: default
        matches: /*[local-name()='Envelope']
    perform:
      iteration:
      - classification:
        - tag:
          - soap
          - webservice
          title: SOAP Envelope
          category-id: optional
          issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: wsdl
          uri: http://schemas.xmlsoap.org/wsdl/
        as: default
        matches: /*[local-name()='definitions']
    perform:
      iteration:
      - classification:
        - tag:
          - webservice
          - wsdl
          title: WSDL Definition
          category-id: optional
          issue-display-mode: detail-only
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap6/java-ee/xml-webservices.windup.xml
