metadata:
- description: "\n            This ruleset provides analysis of JBoss EAP 5 configuration
    XML files that may require individual attention\n            when migrating to
    JBoss EAP 6+. Mainly deals with datasources, JBoss Web and EJB configuration.\n
    \       "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,2.3.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,2.3.0.Final
  sourceTechnology:
  - id: eap
    versionRange: '[5,6)'
  targetTechnology:
  - id: eap
    versionRange: '[6,7)'
  tag:
  - jboss-eap5
  - ejb
  - seam
rules:
  rule:
  - when:
      xmlfile:
      - matches: //mbean[@code='org.jboss.cache.TreeCache']
    perform:
      classification:
      - description:
        - "\n                        JBoss Cache TreeCache is a distributed tree-like
          structure that is replicated across several members.\n                        Updates
          will be multicast to all group members reliably and in the same order.\n
          \                   "
        link:
        - value: ""
          title: JBoss Cache User Guide
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/cache_user_guide/
        - value: ""
          title: JBoss Cache Tutorial
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/cache_tutorial/
        tag:
        - cache
        - distributed
        - cluster
        - jboss-eap5
        title: JBoss Cache
        effort: 3
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: /classloading
    perform:
      classification:
      - description:
        - "\n                        JBoss EAP 5 allows detailed classloading configuration.\n
          \                   "
        link:
        - value: ""
          title: JBoss EAP 5 Classloading
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/5/html/Microcontainer_User_Guide/sect-JBoss_Microcontainer_User_Guide-The_ClassLoading_Layer-ClassLoading.html
        tag:
        - jboss-eap5
        title: JBoss Classloading configuration, typically in jboss-classloading.xml.
        effort: 1
        issue-display-mode: all
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: sc
          uri: http://jboss.com/products/seam/components
        matches: /sc:components
    perform:
      classification:
      - description:
        - "\n                        Allows to configure a Seam component using XML:
          to isolate deployment-specific information from\n                        the
          Java code, to enable the creation of re-usable frameworks, to configure
          Seam's built-in functionality, etc.\n                        Seam provides
          two basic approaches to configuring components:\n                        configuration
          via property settings in a properties file or in `web.xml`,\n                        and
          configuration via `components.xml`.\n                    "
        link:
        - value: ""
          title: JBoss Seam Reference Guide - Configuring Seam components
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/seam_reference_guide/#xml
        tag:
        - seam
        - jboss-eap5
        title: JBoss Seam Components (components.xml)
        effort: 5
        issue-display-mode: all
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: sp
          uri: http://jboss.com/products/seam/pages
        matches: /sp:pages
    perform:
      classification:
      - description:
        - "\n                        The `pages.xml` file specifies the page flow
          and other configuration of the Seam Framework.\n                    "
        link:
        - value: ""
          title: Seam Framework Reference Guide
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/seam_reference_guide/
        tag:
        - seam
        - jboss-eap5
        title: JBoss Seam Pages
        effort: 5
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: /page
        in: '{*}.page.xml'
    perform:
      classification:
      - tag:
        - seam
        - jboss-eap5
        title: JBoss Seam Page
        effort: 3
        issue-display-mode: all
  - when:
      xmlfile:
      - public-id: .*JBoss.+DTD Java EE.+5.*
    perform:
      classification:
      - description:
        - "\n                        A JBoss specific EAR descriptor allows extensions
          to Java EE EAR archives configuration.\n                    "
        link:
        - value: ""
          title: JBoss DTD's
          href: http://www.jboss.org/j2ee/dtd/
        tag:
        - jboss-eap5
        title: JBoss 5.x EAR descriptor
        effort: 5
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='jboss-app']
        in: jboss-app.xml
    perform:
      iteration:
      - xslt:
        - title: JBoss application descriptor - JBoss 5 (MTA-generated)
          extension: -jboss5.xml
          template: resources/jboss-app-to-jboss5.xsl
      - when:
          not:
          - xmlfile:
            - public-id: .*JBoss.+DTD Java EE.+5.*
        classification:
        - description:
          - "\n                            The `jboss-app.xml` file configures a Java
            EE application deployments specifically for JBoss EAP.\n                        "
          tag:
          - configuration
          - deployment
          - descriptor
          - jboss-eap5
          title: JBoss EAR descriptor
          effort: 1
          issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='jboss-web']
        in: jboss-web.xml
    perform:
      classification:
      - description:
        - "\n                        The `jboss-web.xml` file configures a Java EE
          web application specifically for JBoss EAP.\n                        It
          is an extension to standard `web.xml`.\n                    "
        link:
        - value: ""
          title: jboss-web.xml Configuration Reference
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/development_guide/#jboss-webxml_Configuration_Reference
        tag:
        - web
        - configuration
        - deployment
        - descriptor
        - jboss-eap5
        title: JBoss web application descriptor (jboss-web.xml)
        effort: 1
        issue-display-mode: detail-only
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: jbc
          uri: urn:jboss:classloading:1.0
        matches: /jbc:classloading
    perform:
      classification:
      - description:
        - The `jboss-classloading.xml` file allows customization of classloading in
          JBoss EAP 5.
        link:
        - value: ""
          title: JBoss EAP 6 Class Loading and Modules
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/chap-Class_Loading_and_Modules.html
        - value: ""
          title: JBoss EAP 5 Class Loading and Modules
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/5/html/Microcontainer_User_Guide/sect-JBoss_Microcontainer_User_Guide-The_ClassLoading_Layer-ClassLoading.html
        tag:
        - classloading
        title: JBoss 5 classloader configuration (jboss-classloading.xml)
        category-id: mandatory
        issue-display-mode: detail-only
      hint:
      - message: "\n                        In JBoss EAP 6, the classloading configuration
          is not done through `jboss-classloading.xml`.\n                        Since
          EAP 6 it is of modular nature, based on JBoss Modules.\n                        Learn
          how to divide your application's dependencies into modules\n                        and
          what dependencies and APIs are available automatically.\n                    "
        link:
        - value: ""
          title: JBoss EAP 6 Class Loading and Modules
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/chap-Class_Loading_and_Modules.html
        - value: ""
          title: JBoss EAP 5 Class Loading and Modules
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/5/html/Microcontainer_User_Guide/sect-JBoss_Microcontainer_User_Guide-The_ClassLoading_Layer-ClassLoading.html
        tag:
        - classloading
        - jboss-eap5
        title: JBoss 5 classloader configuration (jboss-classloading.xml)
        category-id: mandatory
        effort: 5
  - when:
      xmlfile:
      - matches: //*[local-name()='jboss-deployment-structure']
        in: jboss-deployment-structure.xml
    perform:
      classification:
      - description:
        - "\n                        The `jboss-deployment-structure.xml` file allows
          the creator of the deployment to control the dependencies\n                        and
          classloading of deployments.\n                    "
        link:
        - value: ""
          title: Class Loading and Modules
          href: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/chap-Class_Loading_and_Modules.html
        tag:
        - classloading
        - jboss-eap5
        title: JBoss module and classloading configuration (jboss-deployment-structure.xml)
        effort: 1
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='jbosscmp-jdbc']
        in: jbosscmp-jdbc.xml
    perform:
      classification:
      - description:
        - "\n                        The `jbosscmp-jdbc.xml` is a deployment decriptor
          controlling the Container Managed Persistence (CMP).\n                    "
        link:
        - value: ""
          title: JBoss EAP 5 - The jbosscmp-jdbc Structure
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/administration_and_configuration_guide/index#The_CMP_Engine-The_jbosscmp_jdbc_Structure
        tag:
        - jdbc
        - ejb2
        - jboss-eap5
        title: JBoss EJB 2 CMP Deployment descriptor (jbosscmp-jdbc.xml)
        effort: 5
        category-id: mandatory
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='jboss']
        in: jboss.xml
    perform:
      classification:
      - description:
        - "\n                        The `jboss.xml` descriptor in deployments is
          ignored by JBoss AS 7+ or JBoss EAP 6+.\n                        Replace
          it with `jboss-ejb3.xml`.\n                    "
        link:
        - value: ""
          title: JBoss EAP 5 - EJB References with jboss.xml and jboss-web.xml
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/administration_and_configuration_guide/#ENC_Usage_Conventions-EJB_References_with_jboss.xml_and_jboss_web.xml
        - value: ""
          title: JBoss EAP 6 - Replace the jboss.xml File
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/migration_guide/#Replace_the_jboss.xml_File
        tag:
        - descriptor
        - jboss-eap5
        title: JBoss EJB XML deployment descriptor prior to EAP 6
        category-id: mandatory
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='security-domain' and starts-with(text(), 'java:/jaas/')]
    perform:
      hint:
      - message: "\n                        `java:/jaas/` is a JBoss EAP `security-domain`
          URI.\n                        Remove the `java:/jaas/` prefix for `security-domain`
          elements in AS 7 / EAP 6.\n                    "
        link:
        - value: ""
          title: Java Authentication and Authorization Service (JAAS) Reference Guide
          href: http://docs.oracle.com/javase/7/docs/technotes/guides/security/jaas/JAASRefGuide.html
        tag:
        - security
        - jaas
        - jboss-eap5
        title: JBoss EAP security-domain configuration - java:/jaas/
        category-id: mandatory
        effort: 3
  - when:
      xmlfile:
      - matches: //*[local-name()='policy']
        in: login-config.xml
    perform:
      classification:
      - link:
        - value: ""
          title: JBoss EAP 5 - Login Modules
          href: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/security_guide/#idm139921681412720
        tag:
        - security
        title: JBoss security configuration descriptor (prior to AS 7 / EAP 6)
        issue-display-mode: detail-only
      hint:
      - message: "Before JBoss EAP 6, authentication security domains and login modules
          could be configured in a `login-config.xml` file.\n                    JBoss
          EAP 6+ does not support the `login-config.xml` descriptor. Security is now
          configured inside the server configuration. Please refer to the corresponding
          server security guide.\n                    "
        link:
        - value: ""
          title: JBoss EAP 6.4 - How To Configure Server Security
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/how_to_configure_server_security/
        tag:
        - security
        - jboss-eap5
        title: JBoss security configuration descriptor (login-config.xml)
        category-id: mandatory
        effort: 5
  - when:
      xmlfile:
      - matches: //*[local-name()='ejb-jar']
        in: jboss-ejb3.xml
    perform:
      classification:
      - description:
        - "\n                        A JBoss specific EJB 3 configuration allows extensions
          of Java EE EJB 3.\n                    "
        link:
        - value: ""
          title: jboss-ejb3.xml Deployment Descriptor Reference
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/development_guide/index#jboss-ejb3xml_Deployment_Descriptor_Reference
        tag:
        - jboss-eap5
        title: JBoss EJB 3 deployment descriptor (jboss-ejb3.xml)
        effort: 5
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //*[local-name()='webservices']
        in: jboss-webservices.xml
    perform:
      classification:
      - description:
        - "\n                        JBossWS 4.0 introduces a new deployment descriptor
          to configure web services.\n                        The `jboss-webservices.xml`
          file provides additional information for the given deployment\n                        and
          partially replaces the obsolete `jboss.xml` file.\n\n                        For
          EJB webservice deployments, the expected location of the `jboss-webservices.xml`
          descriptor file\n                        is in the `META-INF/` directory.
          For POJO and EJB webservice endpoints bundled in WAR file,\n                        the
          expected location of the `jboss-webservices.xml` file is in the `WEB-INF/`
          directory.\n                    "
        link:
        - value: ""
          title: JBoss web-services deployment descriptor (jboss-webservices.xml)
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/migration_guide/index#sect-Web_Services_Changes
        tag:
        - jboss-ws
        - descriptor
        - webservice
        - jboss-eap5
        title: JBoss web-services deployment descriptor (jboss-webservices.xml)
        effort: 5
        issue-display-mode: all
  - when:
      xmlfile:
      - matches: //server/mbean[@code='org.jboss.mq.server.jmx.Queue']
    perform:
      classification:
      - tag:
        - jboss-eap5
        title: JBoss EAP 4 JMS configuration
        effort: 5
        issue-display-mode: all
      xslt:
      - title: Queue Destinations Service (MTA-generated)
        extension: -jboss5.xml
        template: resources/jboss4-mq-to-jboss5.xsl
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap6/jboss-eap5/jboss-eap5-xml.windup.xml
