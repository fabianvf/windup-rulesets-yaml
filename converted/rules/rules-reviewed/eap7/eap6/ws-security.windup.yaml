metadata:
- description: "\n            This ruleset provides analysis of applications that
    use WS-Security and may require\n            individual attention when migrating
    to JBoss EAP 7+.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
  sourceTechnology:
  - id: eap
    versionRange: '[6,7)'
  targetTechnology:
  - id: eap
    versionRange: '[7,)'
  tag:
  - ws-security
  - security
rules:
  rule:
  - when:
      javaclass:
      - location:
        - IMPORT
        references: org.apache.ws.security.WSPasswordCallback
    perform:
      hint:
      - message: "\n                        The `org.apache.ws.security.WSPasswordCallback`
          class has moved to package `org.apache.wss4j.common.ext`.\n                        The
          application must be changed to reference to the new package.\n                    "
        link:
        - value: ""
          title: WS-Security Changes
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_ws_security_changes
        tag:
        - ws-security
        quickfix:
        - replacement: org.apache.wss4j.common.ext.WSPasswordCallback
          search: org.apache.ws.security.WSPasswordCallback
          type: REPLACE
          name: WSPasswordCallback
        title: WS-Security WSPasswordCallback's package changed
        category-id: mandatory
        effort: 1
  - when:
      javaclass:
      - location:
        - IMPORT
        references: org.apache.ws.security.saml.ext.{SAMLClassAndPackages}{*}
    perform:
      hint:
      - message: "\n                        Most of the SAML bean objects from the
          `org.apache.ws.security.saml.ext` package have been moved to the `org.apache.wss4j.common.saml`
          package.\n                        The application must be changed to reference
          to the new package.\n                    "
        link:
        - value: ""
          title: WS-Security Changes
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_ws_security_changes
        tag:
        - ws-security
        quickfix:
        - replacement: org.apache.wss4j.common.saml
          search: org.apache.ws.security.saml.ext
          type: REPLACE
          name: SAML_package
        title: WS-Security SAML package changed
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - value: ""
        pattern: (bean.|builder.|OpenSAMLBootstrap|OpenSAMLUtil|SAMLCallback)
      param: SAMLClassAndPackages
  - when:
      javaclass:
      - location:
        - IMPORT
        references: org.apache.ws.security.saml.ext.AssertionWrapper
    perform:
      hint:
      - message: "\n                        The `org.apache.ws.security.saml.ext.AssertionWrapper`
          class have been renamed and moved to the `org.apache.wss4j.common.saml.SamlAssertionWrapper`
          class.\n                        The application must be changed to reference
          and use the new class.\n                    "
        link:
        - value: ""
          title: Javadoc SamlAssertionWrapper
          href: https://access.redhat.com/webassets/avalon/d/red-hat-jboss-enterprise-application-platform/7.0.0/javadocs/org/apache/wss4j/common/saml/SamlAssertionWrapper.html
        tag:
        - ws-security
        quickfix:
        - replacement: org.apache.wss4j.common.saml.SamlAssertionWrapper
          search: org.apache.ws.security.saml.ext.AssertionWrapper
          type: REPLACE
          name: SAML_package
        title: WS-Security AssertionWrapper renamed and moved
        category-id: mandatory
        effort: 1
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap6/ws-security.windup.xml
