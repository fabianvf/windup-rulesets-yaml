metadata:
- description: "\n            This ruleset provides analysis of applications that
    use Hibernate 5.0 and may require\n            individual attention when migrating
    to Hibernate 5.1.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
  sourceTechnology:
  - id: hibernate
    versionRange: (,5.0]
  - id: eap
    versionRange: (,7.0]
  targetTechnology:
  - id: hibernate
    versionRange: '[5.1,)'
  - id: eap
    versionRange: '[7,8)'
  tag:
  - hibernate
rules:
  rule:
  - when:
      javaclass:
      - location:
        - ANNOTATION
        references: javax.persistence.Embeddable
    perform:
      hint:
      - message: "\n                        Previous releases of Hibernate interpreted
          all null column values for an `@Embeddable` to mean the `@Embeddable` itself
          should be null.\n\n                        In this release, applications
          can dictate that Hibernate should instead use an empty `@Embeddable` instance
          by specifying the `hibernate.create_empty_composites.enabled` opt-in setting.\n
          \                   "
        link:
        - value: ""
          title: Hibernate ORM 5.1 Features
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/migration_guide/application_migration_changes#hibernate_5_1_features
        tag:
        - Hibernate
        title: Hibernate 5.1  - @Embeddable changes interpretation
        category-id: optional
        effort: 1
  - when:
      or:
      - javaclass:
        - location:
          - IMPORT
          references: org.hibernate.tool.hbm2ddl.{hbm2ddl_classes}
        - location:
          - IMPORT
          references: org.hibernate.tool.schema.spi.SchemaManagementTool
        - location:
          - IMPORT
          references: org.hibernate.tool.schema.internal.HibernateSchemaManagementTool
    perform:
      hint:
      - message: "\n                        The changes mainly focused on:\n\n                        *
          \ Unifying handling of hbm2ddl.auto and Hibernateâ€™s JPA schema-generation
          support.\n                        *  Removing JDBC concerns from the SPI
          to facilitate true replacement (for OGM)\n\n                        These
          changes are a migration concern since the application is directly using
          some of the changed classes.\n                    "
        link:
        - value: ""
          title: Schema Management Tooling Changes
          href: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.1/html-single/migration_guide/application_migration_changes#schema_management_tooling_changes
        tag:
        - Hibernate
        title: Hibernate 5.1  - Changes to schema management tooling
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - value: ""
        pattern: (SchemaExport|SchemaUpdate|SchemaValidator)
      param: hbm2ddl_classes
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap7/eap70/hibernate50-51.windup.xml
