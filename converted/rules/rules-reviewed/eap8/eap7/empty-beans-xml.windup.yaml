metadata:
- description: "\n            This ruleset provides analysis of Java EE applications
    that need to change their beans.xml deployment descriptor to allow discovery of
    all CDI beans.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
  sourceTechnology:
  - id: eap
    versionRange: '[6,)'
  targetTechnology:
  - id: eap
    versionRange: '[8,)'
  tag:
  - JakartaEE
rules:
  rule:
  - when:
      and:
      - file:
        - filename: beans.xml
        not:
        - or:
          - xmlfile:
            - namespace:
              - value: ""
                prefix: j
                uri: http://xmlns.jcp.org/xml/ns/javaee
              matches: /j:beans
              in: beans.xml
            - matches: /beans
              in: beans.xml
    perform:
      hint:
      - message: 'Add a `beans` element with a `bean-discovery-mode=''all''` attribute
          to an empty beans.xml file if the application has beans without bean defining
          annotations '
        tag:
        - JakartaEE
        quickfix:
        - newline: <beans bean-discovery-mode="all"></beans>
          type: INSERT_LINE
          name: empty-beans-xml-bean-discovery-mode-insert
        title: Use the `all` CDI bean discovery mode if the application has beans
          without bean defining annotations
        category-id: potential
        effort: 1
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/eap8/eap7/empty-beans-xml.windup.xml
