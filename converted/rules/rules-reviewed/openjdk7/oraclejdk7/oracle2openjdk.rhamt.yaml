metadata:
- description: "\n            This ruleset provides analysis with respect to the migration
    from OracleJDK to OpenJDK.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
  sourceTechnology:
  - id: oraclejdk
    versionRange: '[7,)'
  targetTechnology:
  - id: openjdk
    versionRange: '[7,)'
  tag:
  - oracle-jdk
  - jdk
rules:
  rule:
  - when:
      javaclass:
      - location:
        - IMPORT
        references: javafx.{*}
    perform:
      hint:
      - message: "\n                        Currently OpenJFX (open-source implementation
          of JavaFX) is neither shipped nor supported on RHEL.\n                    "
        link:
        - value: ""
          title: Knowledge base article about JavaFX support in RHEL
          href: https://access.redhat.com/solutions/3299701
        - value: ""
          title: RFE to include OpenJFX in RHEL
          href: https://bugzilla.redhat.com/show_bug.cgi?id=1275610
        tag:
        - JavaFX
        title: JavaFX usage
        category-id: potential
  - when:
      or:
      - javaclass:
        - location:
          - IMPORT
          references: '{package}.Font'
        - location:
          - METHOD_CALL
          references: '{package}.{*}Font{*}'
        - location:
          - METHOD_CALL
          references: javax.swing.{*}.{*}Font{*}
    perform:
      hint:
      - message: "\n                        The font library is different in OpenJDK
          compared to OracleJDK.\n                        This means slightly different
          text layout in some cases.\n                        Ensure with tests that
          the output is still as expected.\n                    "
        link:
        - value: ""
          title: Knowledge base article OracleJDK vs. OpenJDK
          href: https://access.redhat.com/solutions/2489791
        tag:
        - fonts
        title: Fonts usage
        category-id: potential
    where:
    - matches:
      - value: ""
        pattern: (java\.awt|javafx\.scene\.text)
      param: package
  - when:
      javaclass:
      - references: jdk.management.resource.{*}
    perform:
      hint:
      - message: "\n                        OpenJDK does not support the resource
          management API for Java.\n                    "
        link:
        - value: ""
          title: Knowledge base article OracleJDK vs. OpenJDK
          href: https://access.redhat.com/solutions/2489791
        tag:
        - Oracle-JDK-resource-management
        title: Resource management API usage
        category-id: potential
  - when:
      javaclass:
      - references: java.awt.Color
    perform:
      hint:
      - message: "\n                        OracleJDK used to use KCMS as color mangement
          system up until JDK7 by default. It switched to Little CMS (LCMS) with JDK8.\n
          \                       OpenJDK uses LCMS. If you continued to use KCMS
          by using the property ``sun.java2d.cmm=sun.java2d.cmm.kcms.KcmsServiceProvider``,
          remove this property and ensure in your tests that your application still
          works as expected.\n                    "
        link:
        - value: ""
          title: Knowledge base article OracleJDK vs. OpenJDK
          href: https://access.redhat.com/solutions/2489791
        tag:
        - JDK-color-management
        title: Color management usage
        category-id: potential
  - when:
      javaclass:
      - location:
        - IMPORT
        references: java.awt.{package}{*}
    perform:
      hint:
      - message: "\n                       OpenJDK has its own 2D library, different
          from the proprietary JDK. This means that its performance may be different.\n
          \                      Ensure during your tests that the application behaves
          as expected.\n                    "
        link:
        - value: ""
          title: Knowledge base article OracleJDK vs. OpenJDK
          href: https://access.redhat.com/solutions/2489791
        tag:
        - 2DLibrary
        title: Java 2D library usage
        category-id: potential
    where:
    - matches:
      - value: ""
        pattern: (geom|color|font|image|image\.renderable|print)
      param: package
  - when:
      or:
      - javaclass:
        - location:
          - METHOD_CALL
          references: java.security.KeyPairGenerator.getInstance({*}
        - location:
          - METHOD_CALL
          references: javax.crypto.KeyAgreement.getInstance({*}
        - location:
          - CONSTRUCTOR_CALL
          - IMPORT
          - INHERITANCE
          - METHOD_CALL
          - VARIABLE_DECLARATION
          references: java.security.spec.EC{*}
        - location:
          - CONSTRUCTOR_CALL
          - IMPORT
          - INHERITANCE
          - METHOD_CALL
          - VARIABLE_DECLARATION
          references: java.security.spec.EllipticCurve{*}
    perform:
      hint:
      - message: "\n                    When on RHEL, OpenJDK uses the NSS crypto
          library from RHEL instead of the built-in one.\n\n                    This
          mostly affects elliptic curve cryptography, where OpenJDK supports all of
          the RHEL curves and none of the others.\n                    \n                    A
          list of all cipher suits of NSS in RHEL:\n\n                    * RHEL6:
          [https://access.redhat.com/articles/1470663](https://access.redhat.com/articles/1470663)\n
          \                   * RHEL7: [https://access.redhat.com/articles/1463663](https://access.redhat.com/articles/1463663)\n
          \                   "
        link:
        - value: ""
          title: Knowledge base article OracleJDK vs. OpenJDK
          href: https://access.redhat.com/solutions/2489791
        tag:
        - crypto
        title: 'Crypto: elliptic curves usage'
        category-id: potential
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/openjdk7/oraclejdk7/oracle2openjdk.rhamt.xml
