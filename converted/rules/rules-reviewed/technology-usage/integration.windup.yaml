metadata:
- description: "\n            This ruleset provides analysis of 3rd party embedded
    frameworks.\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
rules:
  rule:
  - when:
      graph-query:
      - property:
          name: fileName
          searchType: regex
        discriminator: JarArchiveModel
    perform:
      classification:
      - description:
        - "\n                      The application embedds an Apache Camel library.\n
          \                 "
        title: Embedded library - Apache Camel
        category-id: information
      technology-tag:
      - value: Apache Camel
        level: INFORMATIONAL
  - when:
      graph-query:
      - property:
          name: fileName
          searchType: regex
        discriminator: JarArchiveModel
    perform:
      classification:
      - description:
        - "\n                      The application embedds a Teiid library.\n                  "
        title: Embedded library - Teiid
        category-id: information
      technology-tag:
      - value: Teiid
        level: INFORMATIONAL
  - when:
      file:
      - filename: spring-integration{*}.jar
    perform:
      iteration:
      - when:
          not:
          - file:
            - filename: spring-integration{*}test{*}.jar
        perform:
          classification:
          - description:
            - The application embeds the Spring Integration framework.
            title: Embedded framework - Spring Integration
            category-id: information
          technology-tag:
          - value: Spring Integration
            level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}ikasan{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds an Ikasan library.
        title: Embedded framework - Ikasan
        category-id: information
      technology-tag:
      - value: Ikasan
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}swagger{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a Swagger library.
        title: Embedded framework - Swagger
        category-id: information
      technology-tag:
      - value: Swagger
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}apiman{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds an Apiman library.
        title: Embedded framework - Apiman
        category-id: information
      technology-tag:
      - value: Apiman
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}3scale{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a 3scale library.
        title: Embedded framework - 3scale
        category-id: information
      technology-tag:
      - value: 3scale
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}istio{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds an Istio library.
        title: Embedded framework - Istio
        category-id: information
      technology-tag:
      - value: Istio
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}servicemix{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a ServiceMix library.
        title: Embedded framework - ServiceMix
        category-id: information
      technology-tag:
      - value: ServiceMix
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}mule{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a Mule library.
        title: Embedded framework - Mule
        category-id: information
      technology-tag:
      - value: Mule
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}petals{*}eip{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a Petals EIP library.
        title: Embedded framework - Petals EIP
        category-id: information
      technology-tag:
      - value: Petals EIP
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}switchyard{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a SwitchYard library.
        title: Embedded framework - SwitchYard
        category-id: information
      technology-tag:
      - value: SwitchYard
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}synapse{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds an Apache Synapse library.
        title: Embedded framework - Apache Synapse
        category-id: information
      technology-tag:
      - value: Apache Synapse
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}wso2{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a WSO2 library.
        title: Embedded framework - WSO2
        category-id: information
      technology-tag:
      - value: WSO2
        level: INFORMATIONAL
  - when:
      file:
      - filename: '{*}talend{*}.jar'
    perform:
      classification:
      - description:
        - The application embeds a Talend ESB library.
        title: Embedded framework - Talend ESB
        category-id: information
      technology-tag:
      - value: Talend ESB
        level: INFORMATIONAL
  - when:
      xmlfile:
      - namespace:
        - value: ""
          prefix: int
          uri: http://www.springframework.org/schema/integration
        matches: //*/int:channel
    perform:
      classification:
      - description:
        - The application embeds the Spring Integration framework.
        title: Embedded framework - Spring Integration
        category-id: information
      technology-tag:
      - value: Spring Integration
        level: INFORMATIONAL
  - when:
      javaclass:
      - location:
        - IMPORT
        references: org.springframework.integration.dsl.IntegrationFlow
    perform:
      classification:
      - description:
        - The application embeds the Spring Integration framework.
        title: Embedded framework - Spring Integration
        category-id: information
      technology-tag:
      - value: Spring Integration
        level: INFORMATIONAL
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/technology-usage/integration.windup.xml
